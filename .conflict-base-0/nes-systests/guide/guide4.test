# name: guide/guide4.test
# description: Filter transactions with amount > 1000.0 and status == "completed"
# groups: [Function, Filter, Varsized, Float]

CREATE LOGICAL SOURCE transactions(amount FLOAT64, status VARSIZED);
CREATE PHYSICAL SOURCE FOR transactions TYPE File;
ATTACH INLINE
500.0, pending
1500.0,completed
999.99,completed
2000.0,failed
2500.5,completed
1000.0,completed
3000.0,Completed
5000.0,completed

CREATE SINK sink(`TRANSACTIONS$AMOUNT` FLOAT64, `TRANSACTIONS$STATUS` VARSIZED) TYPE File;
SELECT * FROM transactions
WHERE amount > FLOAT64(1000.0) AND status == VARSIZED("completed")
INTO sink;
----
1500.0,completed
2500.5,completed
5000.0,completed
