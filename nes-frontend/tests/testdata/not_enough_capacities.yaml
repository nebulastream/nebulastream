# Tests placement failure due to insufficient capacity.
# The query requires 2 operators (2 filter operators) but source-node has capacity=0
# and sink-node has capacity=1. The placement algorithm should fail with "could not
# place all operators - insufficient capacity".

query: |
  SELECT * FROM (SELECT * FROM mock_source WHERE a > b) WHERE b > a INTO mock_sink

sinks:
  - name: mock_sink
    schema: [ mock_source$a, mock_source$b ]
    host: "sink-node:8080"

logical:
  - name: mock_source
    schema: [ a, b ]

physical:
  - logical: mock_source
    host: "source-node:8080"

workers:
  - host: "sink-node:8080"
    capacity: 1
  - host: "source-node:8080"
    capacity: 0
    downstream:
      - "sink-node:8080"
