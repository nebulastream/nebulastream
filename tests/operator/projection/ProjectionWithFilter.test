# name: map/Map_Add.test
# description: Simple map tests with an add function
# groups: [Projection]

Source window UINT64 id UINT64 value UINT64 timestamp
1,1,1000
2,1,1001
3,1,1002
4,2,2000
5,19,19000
6,20,20000
7,21,21000

# [id] (3->1)
SELECT id FROM window WHERE id == 1 AND value == 1 AND timestamp == 1000 INTO SINK
----
1

# [id] (3->1)
SELECT id FROM window WHERE id == 1 AND value == 1 AND timestamp == 1001 INTO SINK
----

# [id] (3->1)
SELECT id * 2 AS new_id, id, value, timestamp, new_id * timestamp AS new_id_x_timestamp  FROM window WHERE id == 1 AND value == 1 AND timestamp == 1000 INTO SINK
----
2 1 1 1000 2000