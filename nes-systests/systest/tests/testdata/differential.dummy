# name: differential_correct.dummy
# description: Test file for differential query parsing.
# groups: [Parser]

# This test case verifies that the parser can correctly distinguish
# between a main query and a differential query, which is provided
# instead of a result set.

Source stream INT64 id INT64 value INT64 timestamp INLINE
5,1,1000
10,1,1001
15,1,1002
20,2,2000
25,19,19000
30,20,20000
35,21,21000

SINK streamSink INT64 id INT64 stream$value INT64 stream$timestamp

SELECT id * UINT32(10) AS id, value, timestamp FROM stream INTO streamSink
----
DIFFERENTIAL
SELECT id * UINT32(2) * UINT32(5) AS id, value, timestamp FROM stream INTO streamSink
