# name: map/Map_Add.test
# description: Simple map tests with an add function
# groups: [Map]

CREATE LOGICAL SOURCE stream(id UINT64, value UINT64, timestamp UINT64);
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH INLINE
1,1,1000

CREATE SINK streamSink(stream.id UINT64, stream.value UINT64, stream.timestamp UINT64)  TYPE File;

# Map with add function touches one field
SELECT id + UINT64(1) AS id, value, timestamp FROM stream INTO streamSink;
----
2,1,1000


# The second source is invalid and should therefore
CREATE LOGICAL SOURCE streamBad(id UINT64, value UINT64, timestamp UINT64);
CREATE PHYSICAL SOURCE FOR streamBad TYPE File;
ATTACH INLINE
THISISANINVALIDTOKEN
1,1,1000

CREATE SINK streamSink(streamBad.id UINT64, streamBad.value UINT64, streamBad.timestamp UINT64)  TYPE File;


# Query that is never parsed
SELECT id + UINT64(1) AS id, value, timestamp FROM streamBad INTO streamSink;
----
2,1,1000
