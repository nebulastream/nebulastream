# name: Concat
# description: Checks that concat in projections works as expected
# groups: [Function, Text, Projection]

CREATE LOGICAL SOURCE nameStream(firstName VARSIZED NOT NULL, lastName VARSIZED NOT NULL);
CREATE PHYSICAL SOURCE FOR nameStream TYPE File;
ATTACH INLINE
Edgar,Codd
Jim,Grey
Michael,Stonebraker

CREATE SINK firstNameLastNameSink(firstNameLastName VARSIZED NOT NULL) TYPE File;

SELECT CONCAT(firstName,lastName) AS firstNameLastName FROM nameStream INTO firstNameLastNameSink;
----
EdgarCodd
JimGrey
MichaelStonebraker

SELECT CONCAT(CONCAT(firstName, VARSIZED(" ")), lastName) AS firstNameLastName FROM nameStream INTO firstNameLastNameSink;
----
Edgar Codd
Jim Grey
Michael Stonebraker

SELECT CONCAT(firstName, CONCAT(VARSIZED(" "), lastName)) AS firstNameLastName FROM nameStream INTO firstNameLastNameSink;
----
Edgar Codd
Jim Grey
Michael Stonebraker
