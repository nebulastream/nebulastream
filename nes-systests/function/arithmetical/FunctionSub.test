# name: function/arithmetical/FunctionAdd.test
# description: Simple function sub tests
# groups: [Function, FunctionSub]

Source stream INT8 i8 INT16 i16 INT32 i32 INT64 i64 UINT8 u8 UINT16 u16 UINT32 u32 UINT64 u64 FLOAT32 f32 FLOAT64 f64 INLINE
-42,-129,-32769,-2147483649,42,256,65536,4294967296,23,23

SINK sinkConstant INT32 stream$i8 INT32 stream$i16 INT32 stream$i32 INT64 stream$i64 UINT32 stream$u8 UINT32 stream$u16 UINT32 stream$u32 UINT64 stream$u64 FLOAT32 stream$f32 FLOAT64 stream$f64
SINK sinkI8 INT32 stream$i8_i8 INT32 stream$i8_i8_plus_1 INT32 stream$i8_i16 INT32 stream$i8_i16_plus_1 INT32 stream$i8_i32 INT32 stream$i8_i32_plus_1 INT64 stream$i8_i64 INT64 stream$i8_i64_plus_1 INT32 stream$i8_u8 INT32 stream$i8_u8_plus_1 INT32 stream$i8_u16 INT32 stream$i8_u16_plus_1 UINT32 stream$i8_u32 UINT32 stream$i8_u32_plus_1 UINT64 stream$i8_u64 UINT64 stream$i8_u64_plus_1 FLOAT32 stream$i8_f32 FLOAT32 stream$i8_f32_plus_1 FLOAT64 stream$i8_f64 FLOAT64 stream$i8_f64_plus_1
SINK sinkI16 INT32 stream$i16_i8 INT32 stream$i16_i8_plus_1 INT32 stream$i16_i16 INT32 stream$i16_i16_plus_1 INT32 stream$i16_i32 INT32 stream$i16_i32_plus_1 INT64 stream$i16_i64 INT64 stream$i16_i64_plus_1 INT32 stream$i16_u8 INT32 stream$i16_u8_plus_1 INT32 stream$i16_u16 INT32 stream$i16_u16_plus_1 UINT32 stream$i16_u32 UINT32 stream$i16_u32_plus_1 UINT64 stream$i16_u64 UINT64 stream$i16_u64_plus_1 FLOAT32 stream$i16_f32 FLOAT32 stream$i16_f32_plus_1 FLOAT64 stream$i16_f64 FLOAT64 stream$i16_f64_plus_1
SINK sinkI32 INT32 stream$i32_i8 INT32 stream$i32_i8_plus_1 INT32 stream$i32_i16 INT32 stream$i32_i16_plus_1 INT32 stream$i32_i32 INT32 stream$i32_i32_plus_1 INT64 stream$i32_i64 INT64 stream$i32_i64_plus_1 INT32 stream$i32_u8 INT32 stream$i32_u8_plus_1 INT32 stream$i32_u16 INT32 stream$i32_u16_plus_1 UINT32 stream$i32_u32 UINT32 stream$i32_u32_plus_1 UINT64 stream$i32_u64 UINT64 stream$i32_u64_plus_1 FLOAT32 stream$i32_f32 FLOAT32 stream$i32_f32_plus_1 FLOAT64 stream$i32_f64 FLOAT64 stream$i32_f64_plus_1
SINK sinkI64 INT64 stream$i64_i8 INT64 stream$i64_i8_plus_1 INT64 stream$i64_i16 INT64 stream$i64_i16_plus_1 INT64 stream$i64_i32 INT64 stream$i64_i32_plus_1 INT64 stream$i64_i64 INT64 stream$i64_i64_plus_1 INT64 stream$i64_u8 INT64 stream$i64_u8_plus_1 INT64 stream$i64_u16 INT64 stream$i64_u16_plus_1 INT64 stream$i64_u32 INT64 stream$i64_u32_plus_1 UINT64 stream$i64_u64 UINT64 stream$i64_u64_plus_1 FLOAT32 stream$i64_f32 FLOAT32 stream$i64_f32_plus_1 FLOAT64 stream$i64_f64 FLOAT64 stream$i64_f64_plus_1
SINK sinkU8 INT32 stream$u8_i8 INT32 stream$u8_i8_plus_1 INT32 stream$u8_i16 INT32 stream$u8_i16_plus_1 INT32 stream$u8_i32 INT32 stream$u8_i32_plus_1 INT64 stream$u8_i64 INT64 stream$u8_i64_plus_1 INT32 stream$u8_u8 INT32 stream$u8_u8_plus_1 INT32 stream$u8_u16 INT32 stream$u8_u16_plus_1 UINT32 stream$u8_u32 UINT32 stream$u8_u32_plus_1 UINT64 stream$u8_u64 UINT64 stream$u8_u64_plus_1 FLOAT32 stream$u8_f32 FLOAT32 stream$u8_f32_plus_1 FLOAT64 stream$u8_f64 FLOAT64 stream$u8_f64_plus_1
SINK sinkU16 INT32 stream$u16_i8 INT32 stream$u16_i8_plus_1 INT32 stream$u16_i16 INT32 stream$u16_i16_plus_1 INT32 stream$u16_i32 INT32 stream$u16_i32_plus_1 INT64 stream$u16_i64 INT64 stream$u16_i64_plus_1 INT32 stream$u16_u8 INT32 stream$u16_u8_plus_1 INT32 stream$u16_u16 INT32 stream$u16_u16_plus_1 UINT32 stream$u16_u32 UINT32 stream$u16_u32_plus_1 UINT64 stream$u16_u64 UINT64 stream$u16_u64_plus_1 FLOAT32 stream$u16_f32 FLOAT32 stream$u16_f32_plus_1 FLOAT64 stream$u16_f64 FLOAT64 stream$u16_f64_plus_1
SINK sinkU32 UINT32 stream$u32_i8 UINT32 stream$u32_i8_plus_1 UINT32 stream$u32_i16 UINT32 stream$u32_i16_plus_1 UINT32 stream$u32_i32 UINT32 stream$u32_i32_plus_1 INT64 stream$u32_i64 INT64 stream$u32_i64_plus_1 UINT32 stream$u32_u8 UINT32 stream$u32_u8_plus_1 UINT32 stream$u32_u16 UINT32 stream$u32_u16_plus_1 UINT32 stream$u32_u32 UINT32 stream$u32_u32_plus_1 UINT64 stream$u32_u64 UINT64 stream$u32_u64_plus_1 FLOAT32 stream$u32_f32 FLOAT32 stream$u32_f32_plus_1 FLOAT64 stream$u32_f64 FLOAT64 stream$u32_f64_plus_1
SINK sinkU64 UINT64 stream$u64_i8 UINT64 stream$u64_i8_plus_1 UINT64 stream$u64_i16 UINT64 stream$u64_i16_plus_1 UINT64 stream$u64_i32 UINT64 stream$u64_i32_plus_1 UINT64 stream$u64_i64 UINT64 stream$u64_i64_plus_1 UINT64 stream$u64_u8 UINT64 stream$u64_u8_plus_1 UINT64 stream$u64_u16 UINT64 stream$u64_u16_plus_1 UINT64 stream$u64_u32 UINT64 stream$u64_u32_plus_1 UINT64 stream$u64_u64 UINT64 stream$u64_u64_plus_1 FLOAT32 stream$u64_f32 FLOAT32 stream$u64_f32_plus_1 FLOAT64 stream$u64_f64 FLOAT64 stream$u64_f64_plus_1
SINK sinkF32 FLOAT32 stream$f32_i8 FLOAT32 stream$f32_i8_plus_1 FLOAT32 stream$f32_i16 FLOAT32 stream$f32_i16_plus_1 FLOAT32 stream$f32_i32 FLOAT32 stream$f32_i32_plus_1 FLOAT32 stream$f32_i64 FLOAT32 stream$f32_i64_plus_1 FLOAT32 stream$f32_u8 FLOAT32 stream$f32_u8_plus_1 FLOAT32 stream$f32_u16 FLOAT32 stream$f32_u16_plus_1 FLOAT32 stream$f32_u32 FLOAT32 stream$f32_u32_plus_1 FLOAT32 stream$f32_u64 FLOAT32 stream$f32_u64_plus_1 FLOAT32 stream$f32_f32 FLOAT32 stream$f32_f32_plus_1 FLOAT64 stream$f32_f64 FLOAT64 stream$f32_f64_plus_1
SINK sinkF64 FLOAT64 stream$f64_i8 FLOAT64 stream$f64_i8_plus_1 FLOAT64 stream$f64_i16 FLOAT64 stream$f64_i16_plus_1 FLOAT64 stream$f64_i32 FLOAT64 stream$f64_i32_plus_1 FLOAT64 stream$f64_i64 FLOAT64 stream$f64_i64_plus_1 FLOAT64 stream$f64_u8 FLOAT64 stream$f64_u8_plus_1 FLOAT64 stream$f64_u16 FLOAT64 stream$f64_u16_plus_1 FLOAT64 stream$f64_u32 FLOAT64 stream$f64_u32_plus_1 FLOAT64 stream$f64_u64 FLOAT64 stream$f64_u64_plus_1 FLOAT64 stream$f64_f32 FLOAT64 stream$f64_f32_plus_1 FLOAT64 stream$f64_f64 FLOAT64 stream$f64_f64_plus_1


# Todo #442: the below system level tests currently perform downcasts.
# Check if different numeric types support the sub operation
SELECT
    i8 - INT32(42) AS i8,
    i16 - INT32(42) AS i16,
    i32 - INT32(42) AS i32,
    i64 - INT32(42) AS i64,

    u8 - UINT32(42) AS u8,
    u16 - UINT32(42) AS u16,
    u32 - UINT32(42) AS u32,
    u64 - UINT32(42) AS u64,

    f32 - FLOAT32(42.0) AS f32,
    f64 - FLOAT64(42.0) AS f64
FROM stream INTO sinkConstant
----
-84,-171,-32811,-2147483691,0,214,65494,4294967254,-19.0,-19.0

# Sub i8 value with all other data types
SELECT
    # signed
    i8 - i8 AS i8_i8,
    i8 - i8 + INT8(1) AS i8_i8_plus_1,
    i8 - i16 AS i8_i16,
    i8 - i16 + INT16(1) AS i8_i16_plus_1,
    i8 - i32 AS i8_i32,
    i8 - i32 + INT32(1) AS i8_i32_plus_1,
    i8 - i64 AS i8_i64,
    i8 - i64 + INT64(1) AS i8_i64_plus_1,
    # unsigned
    i8 - u8  AS i8_u8,
    i8 - u8 + UINT8(1) AS i8_u8_plus_1,
    i8 - u16 AS i8_u16,
    i8 - u16 + UINT16(1) AS i8_u16_plus_1,
    i8 - u32 AS i8_u32,
    i8 - u32 + UINT32(1) AS i8_u32_plus_1,
    i8 - u64 AS i8_u64,
    i8 - u64 + UINT64(1) AS i8_u64_plus_1,
    # float
    i8 - f32 AS i8_f32,
    i8 - f32 + FLOAT32(1) AS i8_f32_plus_1,
    i8 - f64 AS i8_f64,
    i8 - f64 + FLOAT64(1) AS i8_f64_plus_1
FROM stream INTO sinkI8
----
0,1,87,88,32727,32728,2147483607,2147483608,-84,-83,-298,-297,4294901718,4294901719,18446744069414584278,18446744069414584279,-65.000000,-64.000000,-65.000000,-64.000000

# Sub i16 value with all other data types
SELECT
    # signed
    i16 - i8 AS i16_i8,
    i16 - i8 + INT8(1) AS i16_i8_plus_1,
    i16 - i16 AS i16_i16,
    i16 - i16 + INT16(1) AS i16_i16_plus_1,
    i16 - i32 AS i16_i32,
    i16 - i32 + INT32(1) AS i16_i32_plus_1,
    i16 - i64 AS i16_i64,
    i16 - i64 + INT64(1) AS i16_i64_plus_1,
    # unsigned
    i16 - u8 AS i16_u8,
    i16 - u8 + UINT8(1) AS i16_u8_plus_1,
    u16 - i16 AS i16_u16,
    u16 - i16 + UINT16(1) AS i16_u16_plus_1,
    i16 - u32 AS i16_u32,
    i16 - u32 + UINT32(1) AS i16_u32_plus_1,
    i16 - u64 AS i16_u64,
    i16 - u64 + UINT32(1) AS i16_u64_plus_1,
    # float
    i16 - f32 AS i16_f32,
    i16 - f32 + FLOAT32(1) AS i16_f32_plus_1,
    i16 - f64 AS i16_f64,
    i16 - f64 + FLOAT64(1) AS i16_f64_plus_1
FROM stream INTO sinkI16
----
-87,-86,0,1,32640,32641,2147483520,2147483521,-171,-170,385,386,4294901631,4294901632,18446744069414584191,18446744069414584192,-152.000000,-151.000000,-152.000000,-151.000000

# Sub i32 value with all other data types
SELECT
    # signed
    i32 - i8 AS i32_i8,
    i32 - i8 + INT8(1) AS i32_i8_plus_1,
    i32 - i16 AS i32_i16,
    i32 - i16 + INT16(1) AS i32_i16_plus_1,
    i32 - i32 AS i32_i32,
    i32 - i32 + INT32(1) AS i32_i32_plus_1,
    i32 - i64 AS i32_i64,
    i32 - i64 + INT64(1) AS i32_i64_plus_1,
    # unsigned
    i32 - u8 AS i32_u8,
    i32 - u8 + UINT8(1) AS i32_u8_plus_1,
    i32 - u16 AS i32_u16,
    i32 - u16 + UINT16(1) AS i32_u16_plus_1,
    i32 - u32 AS i32_u32,
    i32 - u32 + UINT32(1) AS i32_u32_plus_1,
    i32 - u64 AS i32_u64,
    i32 - u64 + UINT32(1) AS i32_u64_plus_1,
    # float
    i32 - f32 AS i32_f32,
    i32 - f32 + FLOAT32(1) AS i32_f32_plus_1,
    i32 - f64 AS i32_f64,
    i32 - f64 + FLOAT64(1) AS i32_f64_plus_1
FROM stream INTO sinkI32
----
-32727,-32726,-32640,-32639,0,1,2147450880,2147450881,-32811,-32810,-33025,-33024,4294868991,4294868992,18446744069414551551,18446744069414551552,-32792.000000,-32791.000000,-32792.000000,-32791.000000

# Sub i64 value with all other data types
SELECT
    # signed
    i64 - i8 AS i64_i8,
    i64 - i8 + INT8(1) AS i64_i8_plus_1,
    i64 - i16 AS i64_i16,
    i64 - i16 + INT16(1) AS i64_i16_plus_1,
    i64 - i32 AS i64_i32,
    i64 - i32 + INT32(1) AS i64_i32_plus_1,
    i64 - i64 AS i64_i64,
    i64 - i64 + INT64(1) AS i64_i64_plus_1,
    # unsigned
    i64 - u8 AS i64_u8,
    i64 - u8 + UINT32(1) AS i64_u8_plus_1,
    i64 - u16 AS i64_u16,
    i64 - u16 + UINT32(1) AS i64_u16_plus_1,
    i64 - u32 AS i64_u32,
    i64 - u32 + UINT32(1) AS i64_u32_plus_1,
    i64 - u64 AS i64_u64,
    i64 - u64 + UINT32(1) AS i64_u64_plus_1,
    # float
    i64 - f32 AS i64_f32,
    i64 - f32 + FLOAT32(1) AS i64_f32_plus_1,
    i64 - f64 AS i64_f64,
    i64 - f64 + FLOAT64(1) AS i64_f64_plus_1
FROM stream INTO sinkI64
----
-2147483607,-2147483606,-2147483520,-2147483519,-2147450880,-2147450879,0,1,-2147483691,-2147483690,-2147483905,-2147483904,-2147549185,-2147549184,18446744067267100671,18446744067267100672,-2147483648.000000,-2147483648.000000,-2147483672.000000,-2147483671.000000


# Sub u8 value with all other data types
SELECT
    # signed
    u8 - i8 AS u8_i8,
    u8 - i8 + INT8(1) AS u8_i8_plus_1,
    u8 - i16 AS u8_i16,
    u8 - i16 + INT16(1) AS u8_i16_plus_1,
    u8 - i32 AS u8_i32,
    u8 - i32 + INT32(1) AS u8_i32_plus_1,
    u8 - i64 AS u8_i64,
    u8 - i64 + INT64(1) AS u8_i64_plus_1,
    # unsigned
    u8 - u8  AS u8_u8,
    u8 - u8 + UINT8(1) AS u8_u8_plus_1,
    u8 - u16 AS u8_u16,
    u8 - u16 + UINT16(1) AS u8_u16_plus_1,
    u8 - u32 AS u8_u32,
    u8 - u32 + UINT32(1) AS u8_u32_plus_1,
    u8 - u64 AS u8_u64,
    u8 - u64 + UINT64(1) AS u8_u64_plus_1,
    # float
    u8 - f32 AS u8_f32,
    u8 - f32 + FLOAT32(1) AS u8_f32_plus_1,
    u8 - f64 AS u8_f64,
    u8 - f64 + FLOAT64(1) AS u8_f64_plus_1
FROM stream INTO sinkU8
----
84,85,171,172,32811,32812,2147483691,2147483692,0,1,-214,-213,4294901802,4294901803,18446744069414584362,18446744069414584363,19.000000,20.000000,19.000000,20.000000

# Sub u16 value with all other data types
SELECT
    # signed
    u16 - i8 AS u16_i8,
    u16 - i8 + INT8(1) AS u16_i8_plus_1,
    u16 - i16 AS u16_i16,
    u16 - i16 + INT16(1) AS u16_i16_plus_1,
    u16 - i32 AS u16_i32,
    u16 - i32 + INT32(1) AS u16_i32_plus_1,
    u16 - i64 AS u16_i64,
    u16 - i64 + INT64(1) AS u16_i64_plus_1,
    # unsigned
    u16 - u8 AS u16_u8,
    u16 - u8 + UINT8(1) AS u16_u8_plus_1,
    u16 - i16 AS u16_u16,
    u16 - i16 + INT16(1) AS u16_u16_plus_1,
    u16 - u32 AS u16_u32,
    u16 - u32 + UINT32(1) AS u16_u32_plus_1,
    u16 - u64 AS u16_u64,
    u16 - u64 + UINT32(1) AS u16_u64_plus_1,
    # float
    u16 - f32 AS u16_f32,
    u16 - f32 + FLOAT32(1) AS u16_f32_plus_1,
    u16 - f64 AS u16_f64,
    u16 - f64 + FLOAT64(1) AS u16_f64_plus_1
FROM stream INTO sinkU16
----
298,299,385,386,33025,33026,2147483905,2147483906,214,215,385,386,4294902016,4294902017,18446744069414584576,18446744069414584577,233.000000,234.000000,233.000000,234.000000

# Sub u32 value with all other data types
SELECT
    # signed
    u32 - i8 AS u32_i8,
    u32 - i8 + INT8(1) AS u32_i8_plus_1,
    u32 - i16 AS u32_i16,
    u32 - i16 + INT16(1) AS u32_i16_plus_1,
    u32 - i32 AS u32_i32,
    u32 - i32 + INT32(1) AS u32_i32_plus_1,
    u32 - i64 AS u32_i64,
    u32 - i64 + INT64(1) AS u32_i64_plus_1,
    # unsigned
    u32 - u8 AS u32_u8,
    u32 - u8 + UINT32(1) AS u32_u8_plus_1,
    u32 - u16 AS u32_u16,
    u32 - u16 + UINT32(1) AS u32_u16_plus_1,
    u32 - u32 AS u32_u32,
    u32 - u32 + UINT32(1) AS u32_u32_plus_1,
    u32 - u64 AS u32_u64,
    u32 - u64 + UINT32(1) AS u32_u64_plus_1,
    # float
    u32 - f32 AS u32_f32,
    u32 - f32 + FLOAT32(1) AS u32_f32_plus_1,
    u32 - f64 AS u32_f64,
    u32 - f64 + FLOAT64(1) AS u32_f64_plus_1
FROM stream INTO sinkU32
----
65578,65579,65665,65666,98305,98306,2147549185,2147549186,65494,65495,65280,65281,0,1,18446744069414649856,18446744069414649857,65513.000000,65514.000000,65513.000000,65514.000000

# Sub u64 value with all other data types
SELECT
    # signed
    u64 - i8 AS u64_i8,
    u64 - i8 + INT8(1) AS u64_i8_plus_1,
    u64 - i16 AS u64_i16,
    u64 - i16 + INT16(1) AS u64_i16_plus_1,
    u64 - i32 AS u64_i32,
    u64 - i32 + INT32(1) AS u64_i32_plus_1,
    u64 - i64 AS u64_i64,
    u64 - i64 + INT64(1) AS u64_i64_plus_1,
    # unsigned
    u64 - u8 AS u64_u8,
    u64 - u8 + UINT32(1) AS u64_u8_plus_1,
    u64 - u16 AS u64_u16,
    u64 - u16 + UINT32(1) AS u64_u16_plus_1,
    u64 - u32 AS u64_u32,
    u64 - u32 + UINT32(1) AS u64_u32_plus_1,
    u64 - u64 AS u64_u64,
    u64 - u64 + UINT32(1) AS u64_u64_plus_1,
    # float
    u64 - f32 AS u64_f32,
    u64 - f32 + FLOAT32(1) AS u64_f32_plus_1,
    u64 - f64 AS u64_f64,
    u64 - f64 + FLOAT64(1) AS u64_f64_plus_1
FROM stream INTO sinkU64
----
4294967338,4294967339,4294967425,4294967426,4295000065,4295000066,6442450945,6442450946,4294967254,4294967255,4294967040,4294967041,4294901760,4294901761,0,1,4294967296.000000,4294967296.000000,4294967273.000000,4294967274.000000

# Equal f32 value with all other data types
SELECT
    # signed
    f32 - i8 AS f32_i8,
    f32 - i8 + INT8(1) AS f32_i8_plus_1,
    f32 - i16 AS f32_i16,
    f32 - i16 + INT16(1) AS f32_i16_plus_1,
    f32 - i32 AS f32_i32,
    f32 - i32 + INT32(1) AS f32_i32_plus_1,
    f32 - i64 AS f32_i64,
    f32 - i64 + INT64(1) AS f32_i64_plus_1,
    # unsigned
    f32 - u8 AS f32_u8,
    f32 - u8 + UINT32(1) AS f32_u8_plus_1,
    f32 - u16 AS f32_u16,
    f32 - u16 + UINT32(1) AS f32_u16_plus_1,
    f32 - u32 AS f32_u32,
    f32 - u32 + UINT32(1) AS f32_u32_plus_1,
    f32 - u64 AS f32_u64,
    f32 - u64 + UINT32(1) AS f32_u64_plus_1,
    # float
    f32 - f32 AS f32_f32,
    f32 - f32 + FLOAT32(1) AS f32_f32_plus_1,
    f32 - f64 AS f32_f64,
    f32 - f64 + FLOAT64(1) AS f32_f64_plus_1
FROM stream INTO sinkF32
----
65.000000,66.000000,152.000000,153.000000,32792.000000,32793.000000,2147483648.000000,2147483648.000000,-19.000000,-18.000000,-233.000000,-232.000000,-65513.000000,-65512.000000,-4294967296.000000,-4294967296.000000,0.000000,1.000000,0.000000,1.000000


# Equal f64 value with all other data types
SELECT
    # signed
    f64 - i8 AS f64_i8,
    f64 - i8 + INT8(1) AS f64_i8_plus_1,
    f64 - i16 AS f64_i16,
    f64 - i16 + INT16(1) AS f64_i16_plus_1,
    f64 - i32 AS f64_i32,
    f64 - i32 + INT32(1) AS f64_i32_plus_1,
    f64 - i64 AS f64_i64,
    f64 - i64 + INT64(1) AS f64_i64_plus_1,
    # unsigned
    f64 - u8 AS f64_u8,
    f64 - u8 + UINT32(1) AS f64_u8_plus_1,
    f64 - u16 AS f64_u16,
    f64 - u16 + UINT32(1) AS f64_u16_plus_1,
    f64 - u32 AS f64_u32,
    f64 - u32 + UINT32(1) AS f64_u32_plus_1,
    f64 - u64 AS f64_u64,
    f64 - u64 + UINT32(1) AS f64_u64_plus_1,
    # float
    f64 - f32 AS f64_f32,
    f64 - f32 + FLOAT32(1) AS f64_f32_plus_1,
    f64 - f64 AS f64_f64,
    f64 - f64 + FLOAT64(1) AS f64_f64_plus_1
FROM stream INTO sinkF64
----
65.000000,66.000000,152.000000,153.000000,32792.000000,32793.000000,2147483648.000000,2147483648.000000,-19.000000,-18.000000,-233.000000,-232.000000,-65513.000000,-65512.000000,-4294967296.000000,-4294967296.000000,0.000000,1.000000,0.000000,1.000000

