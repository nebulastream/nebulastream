# name: function/arithmetical/FunctionAdd.test
# description: Simple function sub tests
# groups: [Function, FunctionSub]

Source window INT8 val_i8 INT16 val_i16 INT32 val_i32 INT64 val_i64 UINT8 val_u8 UINT16 val_u16 UINT32 val_u32 UINT64 val_u64 FLOAT32 val_f32 FLOAT64 val_f64
-42,-129,-32769,-2147483649,42,256,65536,4294967296,23,23

# Todo #442: the below system level tests currently perform downcasts.
# Check if different numeric types support the equals operation
SELECT
    val_i8 - 42 AS val_i8,
    val_i16 - 42 AS val_i16,
    val_i32 - 42 AS val_i32,
    val_i64 - 42 AS val_i64,

    val_u8 - 42_U AS val_u8,
    val_u16 - 42_U AS val_u16,
    val_u32 - 42_U AS val_u32,
    val_u64 - 42_U AS val_u64,

    val_f32 - 42.0_F AS val_f32,
    val_f64 - 42.0_D AS val_f64
FROM window INTO SINK
----
-84,-171,-32811,-2147483691,0,214,65494,4294967254,-19.000000,-19.000000

# Equal i8 value with all other data types
SELECT
    # signed
    val_i8 - val_i8 AS val_i8_i8,
    val_i8 - val_i8 + 1 AS val_i8_i8_plus_1,
    val_i8 - val_i16 AS val_i8_i16,
    val_i8 - val_i16 + 1 AS val_i8_i16_plus_1,
    val_i8 - val_i32 AS val_i8_i32,
    val_i8 - val_i32 + 1 AS val_i8_i32_plus_1,
    val_i8 - val_i64 AS val_i8_i64,
    val_i8 - val_i64 + 1 AS val_i8_i64_plus_1,
    # unsigned
    val_i8 - val_u8  AS val_i8_u8,
    val_i8 - val_u8 + 1_UY AS val_i8_u8_plus_1,
    val_i8 - val_u16 AS val_i8_u16,
    val_i8 - val_u16 + 1_US AS val_i8_u16_plus_1,
    val_i8 - val_u32 AS val_i8_u32,
    val_i8 - val_u32 + 1_U AS val_i8_u32_plus_1,
    val_i8 - val_u64 AS val_i8_u64,
    val_i8 - val_u64 + 1_UL AS val_i8_u64_plus_1,
    # float
    val_i8 - val_f32 AS val_i8_f32_,
    val_i8 - val_f32 + 1_F AS val_i8_f32_plus_1,
    val_i8 - val_f64 AS val_i8_f64,
    val_i8 - val_f64 + 1_D AS val_i8_f64_plus_1
FROM window INTO SINK
----
0,1,87,88,32727,32728,2147483607,2147483608,-84,-83,-298,-297,4294901718,4294901719,18446744069414584278,18446744069414584279,-65.000000,-64.000000,-65.000000,-64.000000

# Equal i16 value with all other data types
SELECT
    # signed
    val_i16 - val_i8 AS val_i16_i8,
    val_i16 - val_i8 + 1 AS val_i16_i8_plus_1,
    val_i16 - val_i16 AS val_i16_i16,
    val_i16 - val_i16 + 1 AS val_i16_i16_plus_1,
    val_i16 - val_i32 AS val_i16_i32,
    val_i16 - val_i32 + 1 AS val_i16_i32_plus_1,
    val_i16 - val_i64 AS val_i16_i64,
    val_i16 - val_i64 + 1 AS val_i16_i64_plus_1,
    # unsigned
    val_i16 - val_u8 AS val_i16_u8,
    val_i16 - val_u8 + 1_U AS val_i16_u8_plus_1,
    val_u16 - val_i16 AS val_i16_u16,
    val_u16 - val_i16 + 1_U AS val_i16_u16_plus_1,
    val_i16 - val_u32 AS val_i16_u32,
    val_i16 - val_u32 + 1_U AS val_i16_u32_plus_1,
    val_i16 - val_u64 AS val_i16_u64,
    val_i16 - val_u64 + 1_U AS val_i16_u64_plus_1,
    # float
    val_i16 - val_f32 AS val_i16_f32,
    val_i16 - val_f32 + 1_F AS val_i16_f32_plus_1,
    val_i16 - val_f64 AS val_i16_f64,
    val_i16 - val_f64 + 1_D AS val_i16_f64_plus_1
FROM window INTO SINK
----
-87,-86,0,1,32640,32641,2147483520,2147483521,-171,-170,385,386,4294901631,4294901632,18446744069414584191,18446744069414584192,-152.000000,-151.000000,-152.000000,-151.000000

# Equal i32 value with all other data types
SELECT
    # signed
    val_i32 - val_i8 AS val_i32_i8,
    val_i32 - val_i8 + 1 AS val_i32_i8_plus_1,
    val_i32 - val_i16 AS val_i32_i16,
    val_i32 - val_i16 + 1 AS val_i32_i16_plus_1,
    val_i32 - val_i32 AS val_i32_i32,
    val_i32 - val_i32 + 1 AS val_i32_i32_plus_1,
    val_i32 - val_i64 AS val_i32_i64,
    val_i32 - val_i64 + 1 AS val_i32_i64_plus_1,
    # unsigned
    val_i32 - val_u8 AS val_i32_u8,
    val_i32 - val_u8 + 1_U AS val_i32_u8_plus_1,
    val_i32 - val_u16 AS val_i32_u16,
    val_i32 - val_u16 + 1_U AS val_i32_u16_plus_1,
    val_i32 - val_u32 AS val_i32_u32,
    val_i32 - val_u32 + 1_U AS val_i32_u32_plus_1,
    val_i32 - val_u64 AS val_i32_u64,
    val_i32 - val_u64 + 1_U AS val_i32_u64_plus_1,
    # float
    val_i32 - val_f32 AS val_i32_f32,
    val_i32 - val_f32 + 1_F AS val_i32_f32_plus_1,
    val_i32 - val_f64 AS val_i32_f64,
    val_i32 - val_f64 + 1_D AS val_i32_f64_plus_1
FROM window INTO SINK
----
-32727,-32726,-32640,-32639,0,1,2147450880,2147450881,-32811,-32810,-33025,-33024,4294868991,4294868992,18446744069414551551,18446744069414551552,-32792.000000,-32791.000000,-32792.000000,-32791.000000

# Equal i64 value with all other data types
SELECT
    # signed
    val_i64 - val_i8 AS val_i64_i8,
    val_i64 - val_i8 + 1 AS val_i64_i8_plus_1,
    val_i64 - val_i16 AS val_i64_i16,
    val_i64 - val_i16 + 1 AS val_i64_i16_plus_1,
    val_i64 - val_i32 AS val_i64_i32,
    val_i64 - val_i32 + 1 AS val_i64_i32_plus_1,
    val_i64 - val_i64 AS val_i64_i64,
    val_i64 - val_i64 + 1 AS val_i64_i64_plus_1,
    # unsigned
    val_i64 - val_u8 AS val_i64_u8,
    val_i64 - val_u8 + 1_U AS val_i64_u8_plus_1,
    val_i64 - val_u16 AS val_i64_u16,
    val_i64 - val_u16 + 1_U AS val_i64_u16_plus_1,
    val_i64 - val_u32 AS val_i64_u32,
    val_i64 - val_u32 + 1_U AS val_i64_u32_plus_1,
    val_i64 - val_u64 AS val_i64_u64,
    val_i64 - val_u64 + 1_U AS val_i64_u64_plus_1,
    # float
    val_i64 - val_f32 AS val_i64_f32,
    val_i64 - val_f32 + 1_F AS val_i64_f32_plus_1,
    val_i64 - val_f64 AS val_i64_f64,
    val_i64 - val_f64 + 1_D AS val_i64_f64_plus_1
FROM window INTO SINK
----
-2147483607,-2147483606,-2147483520,-2147483519,-2147450880,-2147450879,0,1,-2147483691,-2147483690,-2147483905,-2147483904,-2147549185,-2147549184,18446744067267100671,18446744067267100672,-2147483648.000000,-2147483648.000000,-2147483672.000000,-2147483671.000000


# Equal u8 value with all other data types
SELECT
    # signed
    val_u8 - val_i8 AS val_u8_i8,
    val_u8 - val_i8 + 1 AS val_u8_i8_plus_1,
    val_u8 - val_i16 AS val_u8_i16,
    val_u8 - val_i16 + 1 AS val_u8_i16_plus_1,
    val_u8 - val_i32 AS val_u8_i32,
    val_u8 - val_i32 + 1 AS val_u8_i32_plus_1,
    val_u8 - val_i64 AS val_u8_i64,
    val_u8 - val_i64 + 1 AS val_u8_i64_plus_1,
    # unsigned
    val_u8 - val_u8  AS val_u8_u8,
    val_u8 - val_u8 + 1_UY AS val_u8_u8_plus_1,
    val_u8 - val_u16 AS val_u8_u16,
    val_u8 - val_u16 + 1_US AS val_u8_u16_plus_1,
    val_u8 - val_u32 AS val_u8_u32,
    val_u8 - val_u32 + 1_U AS val_u8_u32_plus_1,
    val_u8 - val_u64 AS val_u8_u64,
    val_u8 - val_u64 + 1_UL AS val_u8_u64_plus_1,
    # float
    val_u8 - val_f32 AS val_u8_f32_,
    val_u8 - val_f32 + 1_F AS val_u8_f32_plus_1,
    val_u8 - val_f64 AS val_u8_f64,
    val_u8 - val_f64 + 1_D AS val_u8_f64_plus_1
FROM window INTO SINK
----
84,85,171,172,32811,32812,2147483691,2147483692,0,1,-214,-213,4294901802,4294901803,18446744069414584362,18446744069414584363,19.000000,20.000000,19.000000,20.000000

# Equal u16 value with all other data types
SELECT
    # signed
    val_u16 - val_i8 AS val_u16_i8,
    val_u16 - val_i8 + 1 AS val_u16_i8_plus_1,
    val_u16 - val_i16 AS val_u16_i16,
    val_u16 - val_i16 + 1 AS val_u16_i16_plus_1,
    val_u16 - val_i32 AS val_u16_i32,
    val_u16 - val_i32 + 1 AS val_u16_i32_plus_1,
    val_u16 - val_i64 AS val_u16_i64,
    val_u16 - val_i64 + 1 AS val_u16_i64_plus_1,
    # unsigned
    val_u16 - val_u8 AS val_u16_u8,
    val_u16 - val_u8 + 1_U AS val_u16_u8_plus_1,
    val_u16 - val_i16 AS val_u16_u16,
    val_u16 - val_i16 + 1_U AS val_u16_u16_plus_1,
    val_u16 - val_u32 AS val_u16_u32,
    val_u16 - val_u32 + 1_U AS val_u16_u32_plus_1,
    val_u16 - val_u64 AS val_u16_u64,
    val_u16 - val_u64 + 1_U AS val_u16_u64_plus_1,
    # float
    val_u16 - val_f32 AS val_u16_f32,
    val_u16 - val_f32 + 1_F AS val_u16_f32_plus_1,
    val_u16 - val_f64 AS val_u16_f64,
    val_u16 - val_f64 + 1_D AS val_u16_f64_plus_1
FROM window INTO SINK
----
298,299,385,386,33025,33026,2147483905,2147483906,214,215,385,386,4294902016,4294902017,18446744069414584576,18446744069414584577,233.000000,234.000000,233.000000,234.000000

# Equal u32 value with all other data types
SELECT
    # signed
    val_u32 - val_i8 AS val_u32_i8,
    val_u32 - val_i8 + 1 AS val_u32_i8_plus_1,
    val_u32 - val_i16 AS val_u32_i16,
    val_u32 - val_i16 + 1 AS val_u32_i16_plus_1,
    val_u32 - val_i32 AS val_u32_i32,
    val_u32 - val_i32 + 1 AS val_u32_i32_plus_1,
    val_u32 - val_i64 AS val_u32_i64,
    val_u32 - val_i64 + 1 AS val_u32_i64_plus_1,
    # unsigned
    val_u32 - val_u8 AS val_u32_u8,
    val_u32 - val_u8 + 1_U AS val_u32_u8_plus_1,
    val_u32 - val_u16 AS val_u32_u16,
    val_u32 - val_u16 + 1_U AS val_u32_u16_plus_1,
    val_u32 - val_u32 AS val_u32_u32,
    val_u32 - val_u32 + 1_U AS val_u32_u32_plus_1,
    val_u32 - val_u64 AS val_u32_u64,
    val_u32 - val_u64 + 1_U AS val_u32_u64_plus_1,
    # float
    val_u32 - val_f32 AS val_u32_f32,
    val_u32 - val_f32 + 1_F AS val_u32_f32_plus_1,
    val_u32 - val_f64 AS val_u32_f64,
    val_u32 - val_f64 + 1_D AS val_u32_f64_plus_1
FROM window INTO SINK
----
65578,65579,65665,65666,98305,98306,2147549185,2147549186,65494,65495,65280,65281,0,1,18446744069414649856,18446744069414649857,65513.000000,65514.000000,65513.000000,65514.000000

# Equal u64 value with all other data types
SELECT
    # signed
    val_i64 - val_i8 AS val_u64_i8,
    val_i64 - val_i8 + 1 AS val_u64_i8_plus_1,
    val_i64 - val_i16 AS val_u64_i16,
    val_i64 - val_i16 + 1 AS val_u64_i16_plus_1,
    val_i64 - val_i32 AS val_u64_i32,
    val_i64 - val_i32 + 1 AS val_u64_i32_plus_1,
    val_i64 - val_i64 AS val_u64_i64,
    val_i64 - val_i64 + 1 AS val_u64_i64_plus_1,
    # unsigned
    val_i64 - val_u8 AS val_u64_u8,
    val_i64 - val_u8 + 1_U AS val_u64_u8_plus_1,
    val_i64 - val_u16 AS val_u64_u16,
    val_i64 - val_u16 + 1_U AS val_u64_u16_plus_1,
    val_i64 - val_u32 AS val_u64_u32,
    val_i64 - val_u32 + 1_U AS val_u64_u32_plus_1,
    val_i64 - val_u64 AS val_u64_u64,
    val_i64 - val_u64 + 1_U AS val_u64_u64_plus_1,
    # float
    val_i64 - val_f32 AS val_u64_f32,
    val_i64 - val_f32 + 1_F AS val_u64_f32_plus_1,
    val_i64 - val_f64 AS val_u64_f64,
    val_i64 - val_f64 + 1_D AS val_u64_f64_plus_1
FROM window INTO SINK
----
-2147483607,-2147483606,-2147483520,-2147483519,-2147450880,-2147450879,0,1,-2147483691,-2147483690,-2147483905,-2147483904,-2147549185,-2147549184,18446744067267100671,18446744067267100672,-2147483648.000000,-2147483648.000000,-2147483672.000000,-2147483671.000000
