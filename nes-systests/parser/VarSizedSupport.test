# name: parser/VarSizedSupport.test
# description: parser tests
# groups: [Parser]

CREATE LOGICAL SOURCE streamWithText(id UINT64, value UINT64, text1 VARSIZED, text2 VARSIZED);
CREATE PHYSICAL SOURCE FOR streamWithText TYPE File;
ATTACH INLINE
1,1,test1,test1
12,1,test1,test2
4,1,test2,test2
1,2,test1,test1
11,2,test3,test2
16,2,test1,test1
1,3,test1,test2
11,3,test3,test1
3,3,test1,test2
2,3,test1,test1
6,4,test1,test2
8,5,test1,test2

CREATE SINK sinkStreamWithText(id UINT64, value UINT64, text1 VARSIZED, text2 VARSIZED)  TYPE File;


# Simple source ---> sink test
SELECT * FROM streamWithText INTO sinkStreamWithText;
----
1,1,test1,test1
12,1,test1,test2
4,1,test2,test2
1,2,test1,test1
11,2,test3,test2
16,2,test1,test1
1,3,test1,test2
11,3,test3,test1
3,3,test1,test2
2,3,test1,test1
6,4,test1,test2
8,5,test1,test2
