# name: parser/FieldDelimiterRightBeforeBufferSplit.test
# description: parser tests
# groups: [Parser,Tuples]

# NOTE: assumes that raw tuple buffers are of page size (4096 bytes)

Source multiBuffer UINT64 field_1, UINT64 field_2, UINT64 field_3, UINT64 field_4, UINT64 field_5, UINT64 field_6, UINT64 field_7, UINT64 field_8, UINT64 field_9, UINT64 field_10, UINT64 field_11, UINT64 field_12, UINT64 field_13, UINT64 field_14, UINT64 field_15, UINT64 field_16, UINT64 field_17, UINT64 field_18, UINT64 field_19, UINT64 field_20, UINT64 field_21, UINT64 field_22, UINT64 field_23, UINT64 field_24, UINT64 field_25, UINT64 field_26, UINT64 field_27, UINT64 field_28, UINT64 field_29, UINT64 field_30, UINT64 field_31, UINT64 field_32, UINT64 field_33, UINT64 field_34, UINT64 field_35, UINT64 field_36, UINT64 field_37, UINT64 field_38, UINT64 field_39, UINT64 field_40, UINT64 field_41, UINT64 field_42, UINT64 field_43, UINT64 field_44, UINT64 field_45, UINT64 field_46, UINT64 field_47, UINT64 field_48, UINT64 field_49, UINT64 field_50, UINT64 field_51, UINT64 field_52, UINT64 field_53, UINT64 field_54, UINT64 field_55, UINT64 field_56, UINT64 field_57, UINT64 field_58, UINT64 field_59, UINT64 field_60, UINT64 field_61, UINT64 field_62, UINT64 field_63, UINT64 field_64, UINT64 field_65, UINT64 field_66, UINT64 field_67, UINT64 field_68, UINT64 field_69, UINT64 field_70, UINT64 field_71, UINT64 field_72, UINT64 field_73, UINT64 field_74, UINT64 field_75, UINT64 field_76, UINT64 field_77, UINT64 field_78, UINT64 field_79, UINT64 field_80, UINT64 field_81, UINT64 field_82, UINT64 field_83, UINT64 field_84, UINT64 field_85, UINT64 field_86, UINT64 field_87, UINT64 field_88, UINT64 field_89, UINT64 field_90, UINT64 field_91, UINT64 field_92, UINT64 field_93, UINT64 field_94, UINT64 field_95, UINT64 field_96, UINT64 field_97, UINT64 field_98, UINT64 field_99, UINT64 field_100, UINT64 field_101, UINT64 field_102, UINT64 field_103, UINT64 field_104, UINT64 field_105, UINT64 field_106, UINT64 field_107, UINT64 field_108, UINT64 field_109, UINT64 field_110, UINT64 field_111, UINT64 field_112, UINT64 field_113, UINT64 field_114, UINT64 field_115, UINT64 field_116, UINT64 field_117, UINT64 field_118, UINT64 field_119, UINT64 field_120, UINT64 field_121, UINT64 field_122, UINT64 field_123, UINT64 field_124, UINT64 field_125, UINT64 field_126, UINT64 field_127, UINT64 field_128, UINT64 field_129, UINT64 field_130, UINT64 field_131, UINT64 field_132, UINT64 field_133, UINT64 field_134, UINT64 field_135, UINT64 field_136, UINT64 field_137, UINT64 field_138, UINT64 field_139, UINT64 field_140, UINT64 field_141, UINT64 field_142, UINT64 field_143, UINT64 field_144, UINT64 field_145, UINT64 field_146, UINT64 field_147, UINT64 field_148, UINT64 field_149, UINT64 field_150, UINT64 field_151, UINT64 field_152, UINT64 field_153, UINT64 field_154, UINT64 field_155, UINT64 field_156, UINT64 field_157, UINT64 field_158, UINT64 field_159, UINT64 field_160, UINT64 field_161, UINT64 field_162, UINT64 field_163, UINT64 field_164, UINT64 field_165, UINT64 field_166, UINT64 field_167, UINT64 field_168, UINT64 field_169, UINT64 field_170, UINT64 field_171, UINT64 field_172, UINT64 field_173, UINT64 field_174, UINT64 field_175, UINT64 field_176, UINT64 field_177, UINT64 field_178, UINT64 field_179, UINT64 field_180, UINT64 field_181, UINT64 field_182, UINT64 field_183, UINT64 field_184, UINT64 field_185, UINT64 field_186, UINT64 field_187, UINT64 field_188, UINT64 field_189, UINT64 field_190, UINT64 field_191, UINT64 field_192, UINT64 field_193, UINT64 field_194, UINT64 field_195, UINT64 field_196, UINT64 field_197
18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,18446744073709551615,1844674407370955161,1,8

# Description: Checks if we the parser correctly handles a field delimiter (',') right before a buffer split (4096 bytes)
# Source contains 4097 bytes. (starting from 1) byte 4096 is ',' and byte 4096 is '8'
# Thus, the source completely fills one raw buffer (4096 bytes) and writes the last field (and byte) to another
# (also checks if the parser correctly handles a single char in a second buffer)
SELECT * FROM multiBuffer INTO SINK
----
18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 18446744073709551615 1844674407370955161 1 8
