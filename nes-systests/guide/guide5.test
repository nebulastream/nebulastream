# name: guide/guide5.test
# description: Test UNION between two sources s and t
# groups: [SetOps, Union]

CREATE LOGICAL SOURCE s(a INT64 NOT NULL, b VARSIZED NOT NULL);
CREATE PHYSICAL SOURCE FOR s TYPE File;
ATTACH INLINE
1,foo
2,bar
3,foo

CREATE LOGICAL SOURCE t(a INT64 NOT NULL, b VARSIZED NOT NULL);
CREATE PHYSICAL SOURCE FOR t TYPE File;
ATTACH INLINE
3,foo
4,baz
5,qux

CREATE SINK sink(`A` INT64 NOT NULL, `B` VARSIZED NOT NULL) TYPE File;

SELECT a, b FROM s
UNION
SELECT a, b FROM t
INTO sink;
----
1,foo
2,bar
3,foo
3,foo
4,baz
5,qux
