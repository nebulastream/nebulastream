# name: operator/aggregation/SerializationTest.test
# description: Test Hashmap Serialization
# groups: [Aggregation, Serialization]


CREATE LOGICAL SOURCE stream(i64 INT64, ts UINT64);
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH INLINE
1,1
2,2
3,3
4,4
5,5
6,6
7,7
8,8
9,9

CREATE LOGICAL SOURCE stream2(i64 INT64, ts UINT64);
CREATE PHYSICAL SOURCE FOR stream2 TYPE File;
ATTACH INLINE
0,1
0,2
0,3
0,4
0,5
0,6
0,7
0,8
0,9

CREATE SINK sinkStream(stream.start UINT64, stream.end UINT64, stream.i64_out UINT64)  TYPE File;
CREATE SINK sinkStream2(stream2.start UINT64, stream2.end UINT64, stream2.i64_out UINT64)  TYPE File;

SELECT start, end, COUNT(i64) as i64_out FROM stream WINDOW TUMBLING(ts, size 100ms) INTO sinkStream;
----
0,100,9

SELECT start, end, COUNT(i64) as i64_out FROM stream2 WINDOW TUMBLING(ts, size 100ms) INTO sinkStream2;
----
0,100,9
