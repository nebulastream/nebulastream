# name: selection/Selection_Null.test
# description: Selection tests with null values
# groups: [Selection, NullHandling]

CREATE LOGICAL SOURCE stream(ts UINT64, value1 INT32 NULL, value2 VARSIZED NULL);
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH INLINE
1,,
2,,
3,1,one
4,1,one
5,1,one
6,,empty
7,2,two
8,0,zero
9,-1,
10,,


CREATE SINK sink0(stream.ts UINT64, stream.value1 INT32 NULL, stream.value2 VARSIZED NULL) TYPE File;
CREATE SINK sink1(stream.ts UINT64, stream.value1 INT32 NULL) TYPE File;

# Filter equal on INT32 with null
SELECT * FROM stream WHERE value1 == INT32(1) INTO sink0;
----
3,1,one
4,1,one
5,1,one

# Filter equal on VARSIZED with null
SELECT ts, value1 FROM stream WHERE value2 == VARSIZED("one") INTO sink1;
----
3,1
4,1
5,1

# Filter < 1, keep all values
SELECT * FROM stream WHERE value1 < INT32(1) INTO sink0;
----
8,0,zero
9,-1,NULL

# Filter that keeps only non null values
SELECT * FROM stream WHERE NOT ISNULL(value1) INTO sink0;
----
3,1,one
4,1,one
5,1,one
7,2,two
8,0,zero
9,-1,NULL

# Filter that keeps only null values
SELECT * FROM stream WHERE ISNULL(value2) INTO sink0;
----
1,NULL,NULL
2,NULL,NULL
9,-1,NULL
10,NULL,NULL
