# name: selection/Selection_Null.test
# description: Selection tests with null values
# groups: [Selection]

Source stream UINT64 timestamp_nullable INT32 value1_nullable VARSIZED value2_nullable
1,,
,,
3,1,one
4,1,
5,1,one
6,,one
7,2,two
8,0,zero
9,-1,
10,,

SINK sink0 UINT64 stream$timestamp_nullable INT32 stream$value1_nullable VARSIZED stream$value2_nullable
SINK sink1 UINT64 stream$timestamp_nullable VARSIZED stream$value2_nullable

# Filter equal on INT32 with null
SELECT * FROM stream WHERE value1_nullable == 1 INTO sink0
----
3,1,one
4,1,
5,1,one

# Filter equal on VARSIZED with null
SELECT timestamp_nullable, value1_nullable FROM stream WHERE value2_nullable == "one" INTO sink1
----
3,1
5,1
6,
