# name: projection/Projection.test
# description: Simple map tests with an add function
# groups: [Projection]

Source stream UINT64 id FLOAT64 value UINT64 timestamp
1,1.3,1000
2,1.3,1001
3,1.3,1002
4,2.3,2000
5,19.3,19000
6,20.3,20000
7,21.3,21000

SINK sinkFloatValue UINT64 stream$id FLOAT64 stream$value

SELECT id, value FROM stream WHERE id < UINT64(4) INTO sinkFloatValue
----
1 1.3
2 1.3
3 1.3


Source streamWithText UINT64 id VARSIZED value UINT64 timestamp
1,test1,1000
2,test3,2000
4,test2,1002
12,test1,1001

SINK sinkTextValue UINT64 streamWithText$id VARSIZED streamWithText$value

SELECT id, value FROM streamWithText WHERE id < UINT64(4) INTO sinkTextValue
----
1 test1
2 test3

################################
# QUERIES THAT ARE NOT WORKING:
################################

# Query 1: cuts of last character of varsized
Source streamWithText UINT64 id VARSIZED value
1,test1
2,test3
4,test2
12,test1

# Query 2: Char is not working (nothing is returned <-- or badly interpreted?)
SELECT value FROM streamWithText INTO sinkTextValue
----
a
b
c

# Query 3: Char is not working (nothing is returned <-- or badly interpreted?)
Source streamWithText UINT64 id VARSIZED value CHAR charValue
1,test1,a
4,test2,b
12,test1,c

SINK sinkTextValue UINT64 streamWithText$id VARSIZED streamWithText$value CHAR streamWithText$charValue

SELECT id, value, charValue FROM streamWithText WHERE id < UINT64(4) INTO sinkTextValue
----
1,test1,a