# name: bug/ProjectUnamedWindowAggregations.test
# description: Aggregations without an AS do not get projected
# groups: [Aggregation, WindowOperators, Projection]

# Source definitions
CREATE LOGICAL SOURCE stream(id UINT64 NOT NULL, value UINT64 NOT NULL, timestamp UINT64 NOT NULL);
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH INLINE
1,1,1000
1,2,1001
12,12,1001


CREATE SINK sinkStream(stream.value_Sum UINT64 NOT NULL)  TYPE File;

# Aggregations without a name also get projected
SELECT SUM(value) FROM stream GROUP BY id WINDOW TUMBLING(timestamp, size 5 sec) INTO sinkStream;
----
3
12
