# name: projection/Projection.test
# description: Simple map tests with an add function
# groups: [Projection]

Source window UINT64 id UINT64 value UINT64 timestamp
1,1,1000
2,1,1001
3,1,1002
4,2,2000
5,19,19000
6,20,20000
7,21,21000

SINK sinkId UINT64 window$id
SINK sinkValue UINT64 window$value
SINK sinkTimestamp UINT64 window$timestamp
SINK sinkIdValue UINT64 window$id UINT64 window$value
SINK sinkIdTimestamp UINT64 window$id UINT64 window$timestamp
SINK sinkValueTimestamp UINT64 window$value UINT64 window$timestamp
SINK sinkIdValueTimestamp UINT64 window$id UINT64 window$value UINT64 window$timestamp
SINK sinkIdTimestampValue UINT64 window$id UINT64 window$timestamp UINT64 window$value
SINK sinkValueIdTimestamp UINT64 window$value UINT64 window$id UINT64 window$timestamp
SINK sinkValueTimestampId UINT64 window$value UINT64 window$timestamp UINT64 window$id
SINK sinkTimestampIdValue UINT64 window$timestamp UINT64 window$id UINT64 window$value
SINK sinkTimestampValueId UINT64 window$timestamp UINT64 window$value UINT64 window$id

# 0: [id]
SELECT id FROM window INTO sinkId
----
1
2
3
4
5
6
7


# 1: [value]
SELECT value FROM window INTO sinkValue
----
1
1
1
2
19
20
21

# 2: [timestamp]
SELECT timestamp FROM window INTO sinkTimestamp
----
1000
1001
1002
2000
19000
20000
21000

# 3: [id, value]
SELECT id, value FROM window INTO sinkIdValue
----
1,1
2,1
3,1
4,2
5,19
6,20
7,21

# 4: [id, timestamp]
SELECT id, timestamp FROM window INTO sinkIdTimestamp
----
1,1000
2,1001
3,1002
4,2000
5,19000
6,20000
7,21000

# 5: [value, timestamp]
SELECT value, timestamp FROM window INTO sinkValueTimestamp
----
1,1000
1,1001
1,1002
2,2000
19,19000
20,20000
21,21000

# 6: [id, value, timestamp]
SELECT id, value, timestamp FROM window INTO sinkIdValueTimestamp
----
1,1,1000
2,1,1001
3,1,1002
4,2,2000
5,19,19000
6,20,20000
7,21,21000

# 7: [id, timestamp, value]
SELECT id, timestamp, value FROM window INTO sinkIdTimestampValue
----
1,1000,1
2,1001,1
3,1002,1
4,2000,2
5,19000,19
6,20000,20
7,21000,21

# 8: [value, id, timestamp]
SELECT value, id, timestamp FROM window INTO sinkValueIdTimestamp
----
1,1,1000
1,2,1001
1,3,1002
2,4,2000
19,5,19000
20,6,20000
21,7,21000

# 9: [value, timestamp, id]
SELECT value, timestamp, id FROM window INTO sinkValueTimestampId
----
1,1000,1
1,1001,2
1,1002,3
2,2000,4
19,19000,5
20,20000,6
21,21000,7

# 10: [timestamp, id, value]
SELECT timestamp, id, value FROM window INTO sinkTimestampIdValue
----
1000,1,1
1001,2,1
1002,3,1
2000,4,2
19000,5,19
20000,6,20
21000,7,21

# 11: [timestamp, value, id]
SELECT timestamp, value, id FROM window INTO sinkTimestampValueId
----
1000,1,1
1001,1,2
1002,1,3
2000,2,4
19000,19,5
20000,20,6
21000,21,7
