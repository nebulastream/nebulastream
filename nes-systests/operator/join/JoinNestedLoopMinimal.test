# name: join/JoinWithDifferentDataTypes.test
# description: Test join operator and the join function performs the join operation with different data types
# groups: [WindowOperators, Join]
#GlobalConfiguration worker.query_engine.number_of_worker_threads: [1]

CREATE LOGICAL SOURCE stream1(i8_s1 INT8, ts UINT64);
CREATE PHYSICAL SOURCE FOR stream1 TYPE File;
ATTACH INLINE
1,100

CREATE LOGICAL SOURCE stream2(i8_s2 INT8, ts UINT64);
CREATE PHYSICAL SOURCE FOR stream2 TYPE File;
ATTACH INLINE
1,500
2,501
3,502
4,503
5,504
6,505
7,506
8,507
9,508
10,509

CREATE SINK sinkStream1Stream2(stream1stream2.start UINT64, stream1stream2.end UINT64, stream1.i8_s1 INT8, stream1.ts UINT64, stream2.i8_s2 INT8, stream2.ts UINT64)  TYPE File;



# Check if different numeric types support the equals operation for a tumbling stream with event time
SELECT * FROM (SELECT * FROM stream1) JOIN (SELECT * FROM stream2) ON i8_s1 = i8_s2
  WINDOW TUMBLING (ts, size 1 sec) INTO sinkStream1Stream2;
----
0,1000,1,100,1,500

