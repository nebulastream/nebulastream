# name: union/Union.test
# description: Test large unions caused by source expansion
# groups: [Union]

CREATE LOGICAL SOURCE stream(id UINT64, value UINT64, timestamp UINT64);

CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH FILE small/stream8.csv

CREATE SINK file_sink(stream.id UINT64, stream.value UINT64, stream.timestamp UINT64) TYPE File ;

SELECT * FROM stream INTO file_sink;
----
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
