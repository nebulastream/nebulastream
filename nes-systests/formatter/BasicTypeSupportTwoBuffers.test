# name: formatter/BasicTypeSupportTwoBuffers.test
# description: formatter tests
# groups: [Formatter]

# NOTE: assumes that raw tuple buffers are of page size (4096 bytes)
GlobalConfiguration worker.default_query_execution.operator_buffer_size: [4096]

CREATE LOGICAL SOURCE multiBuffer(field_1 BOOLEAN NOT NULL, field_2 INT8 NOT NULL, field_4 INT16 NOT NULL, field_5 INT32 NOT NULL, field_6 INT64 NOT NULL, field_7 UINT8 NOT NULL, field_8 UINT16 NOT NULL, field_9 UINT32 NOT NULL, field_10 UINT64 NOT NULL, field_11 FLOAT32 NOT NULL, field_12 FLOAT64 NOT NULL);
CREATE PHYSICAL SOURCE FOR multiBuffer TYPE File;
ATTACH INLINE
true,-128,-32768,-2147483648,-9223372036854775808,255,65535,4294967295,18446744073709551615,-340282346638528859811704183484516925440.0,-179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
false,127,32767,2147483647,9223372036854775807,0,0,0,0,340282346638528859811704183484516925440.0,179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
true,-128,-32768,-2147483648,-9223372036854775808,255,65535,4294967295,18446744073709551615,-340282346638528859811704183484516925440.0,-179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
false,127,32767,2147483647,9223372036854775807,0,0,0,0,340282346638528859811704183484516925440.0,179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
true,-128,-32768,-2147483648,-9223372036854775808,255,65535,4294967295,18446744073709551615,-340282346638528859811704183484516925440.0,-179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
false,127,32767,2147483647,9223372036854775807,0,0,0,0,340282346638528859811704183484516925440.0,179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
true,-128,-32768,-2147483648,-9223372036854775808,255,65535,4294967295,18446744073709551615,-340282346638528859811704183484516925440.0,-179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
false,127,32767,2147483647,9223372036854775807,0,0,0,0,340282346638528859811704183484516925440.0,179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
true,-128,-32768,-2147483648,-9223372036854775808,255,65535,4294967295,18446744073709551615,-340282346638528859811704183484516925440.0,-179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
false,127,32767,2147483647,9223372036854775807,0,0,0,0,340282346638528859811704183484516925440.0,179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0

CREATE SINK sinkMultiBuffer(multiBuffer.field_1 BOOLEAN NOT NULL, multiBuffer.field_2 INT8 NOT NULL, multiBuffer.field_4 INT16 NOT NULL, multiBuffer.field_5 INT32 NOT NULL, multiBuffer.field_6 INT64 NOT NULL, multiBuffer.field_7 UINT8 NOT NULL, multiBuffer.field_8 UINT16 NOT NULL, multiBuffer.field_9 UINT32 NOT NULL, multiBuffer.field_10 UINT64 NOT NULL, multiBuffer.field_11 FLOAT32 NOT NULL, multiBuffer.field_12 FLOAT64 NOT NULL) TYPE File;

# Description: Check that the formatter supports all basic types. Data does not fit into a single buffer.
# Sets: true/false for bool, lower/uppercase for char and min/max values for integers/floats
SELECT * FROM multiBuffer INTO sinkMultiBuffer;
----
1,-128,-32768,-2147483648,-9223372036854775808,255,65535,4294967295,18446744073709551615,-340282346638528859811704183484516925440.0,-179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
0,127,32767,2147483647,9223372036854775807,0,0,0,0,340282346638528859811704183484516925440.0,179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
1,-128,-32768,-2147483648,-9223372036854775808,255,65535,4294967295,18446744073709551615,-340282346638528859811704183484516925440.0,-179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
0,127,32767,2147483647,9223372036854775807,0,0,0,0,340282346638528859811704183484516925440.0,179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
1,-128,-32768,-2147483648,-9223372036854775808,255,65535,4294967295,18446744073709551615,-340282346638528859811704183484516925440.0,-179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
0,127,32767,2147483647,9223372036854775807,0,0,0,0,340282346638528859811704183484516925440.0,179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
1,-128,-32768,-2147483648,-9223372036854775808,255,65535,4294967295,18446744073709551615,-340282346638528859811704183484516925440.0,-179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
0,127,32767,2147483647,9223372036854775807,0,0,0,0,340282346638528859811704183484516925440.0,179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
1,-128,-32768,-2147483648,-9223372036854775808,255,65535,4294967295,18446744073709551615,-340282346638528859811704183484516925440.0,-179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
0,127,32767,2147483647,9223372036854775807,0,0,0,0,340282346638528859811704183484516925440.0,179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.0
