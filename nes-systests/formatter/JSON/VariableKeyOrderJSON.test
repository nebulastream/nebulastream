# name: JSON.test
# description: tests that the json input formatter supports different orderings for the keys
# groups: [Formatter, JSON]

CREATE LOGICAL SOURCE variableKeyOrderStream(key UINT64 NOT NULL, value UINT64 NOT NULL, name VARSIZED NOT NULL);
CREATE PHYSICAL SOURCE FOR variableKeyOrderStream TYPE File SET("JSON" AS PARSER.`TYPE`);
ATTACH INLINE
{"NAME":"john", "KEY":1, "VALUE":1}
{"VALUE":2, "KEY":1, "NAME":"max"}

CREATE SINK keySink(variableKeyOrderStream.key UINT64 NOT NULL) TYPE File;
CREATE SINK valueSink(variableKeyOrderStream.value UINT64 NOT NULL) TYPE File;
CREATE SINK nameSink(variableKeyOrderStream.name VARSIZED NOT NULL)  TYPE File;
CREATE SINK allFieldsSink(variableKeyOrderStream.key UINT64 NOT NULL, variableKeyOrderStream.value UINT64 NOT NULL, variableKeyOrderStream.name VARSIZED NOT NULL)  TYPE File;

SELECT key FROM variableKeyOrderStream INTO keySink;
----
1
1

SELECT value FROM variableKeyOrderStream INTO valueSink;
----
1
2

SELECT name FROM variableKeyOrderStream INTO nameSink;
----
john
max

SELECT * FROM variableKeyOrderStream INTO allFieldsSink;
----
1,1,john
1,2,max
