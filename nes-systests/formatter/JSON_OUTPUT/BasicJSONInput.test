# name: projection/Projection.test
# description: Simple map tests with an add function
# groups: [Projection,JSON]

CREATE LOGICAL SOURCE stream(id UINT64, value UINT64, timestamp UINT64);
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH INLINE
1,1,1000
2,1,1001
3,1,1002
4,2,2000
5,19,19000
6,20,20000
7,21,21000

SELECT id FROM stream INTO File('JSON' as `SINK`.INPUT_FORMAT);
----
{"STREAM$ID":1}
{"STREAM$ID":2}
{"STREAM$ID":3}
{"STREAM$ID":4}
{"STREAM$ID":5}
{"STREAM$ID":6}
{"STREAM$ID":7}

SELECT * FROM stream INTO File('JSON' as `SINK`.INPUT_FORMAT);
----
{"STREAM$ID":1,"STREAM$VALUE":1,"STREAM$TIMESTAMP":1000}
{"STREAM$ID":2,"STREAM$VALUE":1,"STREAM$TIMESTAMP":1001}
{"STREAM$ID":3,"STREAM$VALUE":1,"STREAM$TIMESTAMP":1002}
{"STREAM$ID":4,"STREAM$VALUE":2,"STREAM$TIMESTAMP":2000}
{"STREAM$ID":5,"STREAM$VALUE":19,"STREAM$TIMESTAMP":19000}
{"STREAM$ID":6,"STREAM$VALUE":20,"STREAM$TIMESTAMP":20000}
{"STREAM$ID":7,"STREAM$VALUE":21,"STREAM$TIMESTAMP":21000}
