# name: projection/Projection.test
# description: Simple map tests with an add function
# groups: [TestContainer]
CREATE LOGICAL SOURCE odbc_source(LabVal_ID INT32);

CREATE PHYSICAL SOURCE FOR odbc_source TYPE ODBC SET("Native" AS PARSER.`TYPE`, "SELECT LabVal_ID FROM dbo.v_Labor_null" AS `SOURCE`.query, "sql_server" AS `SOURCE`.host, "1433" AS `SOURCE`.PORT, "master" AS `SOURCE`.database, "sa" AS `SOURCE`.username, "samplePassword1!" AS `SOURCE`.password, "ODBC Driver 18 for SQL Server" AS `SOURCE`.driver, "dbo.v_Labor_null" AS `SOURCE`.sync_table, "1000" AS `SOURCE`.poll_interval_ms, "true" AS `SOURCE`.trust_server_certificate);

# 1: [id]
#SELECT id FROM stream INTO File();
#SELECT LabVal_ID, mlife_FallNr, Zeitpunkt, GruppenNr, Gruppe, Bez, VarSizedToDouble(Wert) AS doubleWert, Einheit, Wertebereich, SampleNr, TSFail, TSLog, Lab_ID FROM odbc_source INTO File('labor_null_output.csv' AS `SINK`.FILE_PATH,'CSV' as `SINK`.INPUT_FORMAT)
SELECT LabVal_ID FROM odbc_source INTO File();
----
1
2
3
4
5
