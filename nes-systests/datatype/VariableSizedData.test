# name: datatype/VariableSizedData.test
# description: Test for variable sized data types
# groups: [VariableSizedData]


CREATE LOGICAL SOURCE streamWithText(id UINT64 NOT NULL, value UINT64 NOT NULL, text1 VARSIZED NOT NULL, text2 VARSIZED NOT NULL);
CREATE PHYSICAL SOURCE FOR streamWithText TYPE File;
ATTACH INLINE
1,1,test1,test1
12,1,test1,test2
4,1,test2,test2
1,2,test1,test1
11,2,test3,test2
16,2,test1,test1
1,3,test1,test2
11,3,test3,test1
3,3,test1,test2
2,3,test1,test1
6,4,test1,test2
8,5,test1,test2

CREATE SINK sinkStreamWithText(streamWithText.id UINT64 NOT NULL, streamWithText.value UINT64 NOT NULL, streamWithText.text1 VARSIZED NOT NULL, streamWithText.text2 VARSIZED NOT NULL) TYPE File;


# Simple text query
SELECT * FROM streamWithText INTO sinkStreamWithText;
----
1,1,test1,test1
12,1,test1,test2
4,1,test2,test2
1,2,test1,test1
11,2,test3,test2
16,2,test1,test1
1,3,test1,test2
11,3,test3,test1
3,3,test1,test2
2,3,test1,test1
6,4,test1,test2
8,5,test1,test2
