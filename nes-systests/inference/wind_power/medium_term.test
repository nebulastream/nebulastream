# name: inference/wind_power/medium_term.test
# description: Wind Power dataset experiments
# groups: [Inference]

GlobalConfiguration enable_event_trace: [true]
GlobalConfiguration worker.number_of_buffers_in_global_buffer_manager: [131072]
GlobalConfiguration worker.default_query_execution.operator_buffer_size: [16384]
GlobalConfiguration worker.query_engine.number_of_worker_threads: [16]

CREATE LOGICAL SOURCE windPowerSource(timestamp UINT64, value FLOAT64);
CREATE PHYSICAL SOURCE FOR windPowerSource TYPE File;
ATTACH FILE large/wind_power/wind-power.csv

CREATE SINK windPowerVarsizedDiscard(powerProdNext2Min VARSIZED) TYPE Discard;

MODEL minMaxScalerWind TESTDATA/model/wind_power/preprocessor/scaler_wind.onnx
FLOAT64
FLOAT32 value_sc
BATCH_SIZE 1
CACHE NONE SIZE 1

MODEL dLinear_none TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE NONE SIZE 1

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_none, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_2q_16 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE TWO_QUEUES SIZE 16

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_2q_16, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_2q_32 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE TWO_QUEUES SIZE 32

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_2q_32, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_2q_64 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE TWO_QUEUES SIZE 64

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_2q_64, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_2q_128 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE TWO_QUEUES SIZE 128

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_2q_128, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_fifo_16 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE FIFO SIZE 16

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_fifo_16, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_fifo_32 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE FIFO SIZE 32

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_fifo_32, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_fifo_64 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE FIFO SIZE 64

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_fifo_64, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_fifo_128 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE FIFO SIZE 128

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_fifo_128, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_lfu_16 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE LFU SIZE 16

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_lfu_16, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_lfu_32 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE LFU SIZE 32

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_lfu_32, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_lfu_64 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE LFU SIZE 64

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_lfu_64, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_lfu_128 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE LFU SIZE 128

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_lfu_128, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_lru_16 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE LRU SIZE 16

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_lru_16, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_lru_32 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE LRU SIZE 32

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_lru_32, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_lru_64 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE LRU SIZE 64

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_lru_64, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_lru_128 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE LRU SIZE 128

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_lru_128, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_second_chance_16 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE SECOND_CHANCE SIZE 16

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_second_chance_16, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_second_chance_32 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE SECOND_CHANCE SIZE 32

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_second_chance_32, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_second_chance_64 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE SECOND_CHANCE SIZE 64

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_second_chance_64, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----

MODEL dLinear_second_chance_128 TESTDATA/model/wind_power/pretrained/dlinear/dlinear_wind_size_600_stride_60.onnx
VARSIZED
VARSIZED powerProdNext2Min
BATCH_SIZE 1
CACHE SECOND_CHANCE SIZE 128

SELECT powerProdNext2Min FROM (
    SELECT INFER_MODEL(dLinear_second_chance_128, (value_60_sec))
    FROM (
        SELECT ARRAY_AGG(value_sc) AS value_60_sec
        FROM (
            SELECT INFER_MODEL(minMaxScalerWind, (value)) FROM windPowerSource
        )
        WINDOW SLIDING(timestamp, SIZE 600000 ms, ADVANCE BY 60000 ms)
    )
)
INTO windPowerVarsizedDiscard;
----
