# name: differential/ProjectionEquivalence.test
# description: Validate differential queries produce the same results for equivalent projections.
# groups: [Differential, Projection]


CREATE LOGICAL SOURCE stream(id UINT64, value UINT64, timestamp UINT64);
CREATE PHYSICAL SOURCE FOR stream TYPE Generator SET(
    1 AS `SOURCE`.SEED,
    1000 AS `SOURCE`.MAX_RUNTIME_MS,
    'ALL' as `SOURCE`.STOP_GENERATOR_WHEN_SEQUENCE_FINISHES,
    'SEQUENCE UINT64 1 3 1, SEQUENCE UINT64 10 30 10, SEQUENCE UINT64 1000 1002 1' AS `SOURCE`.GENERATOR_SCHEMA
);

CREATE SINK projectionSink(out_id UINT64, out_value UINT64, out_timestamp UINT64) TYPE File;

SELECT id AS out_id, value AS out_value, timestamp AS out_timestamp FROM stream INTO projectionSink;
====
SELECT stream.id AS out_id, stream.value AS out_value, stream.timestamp AS out_timestamp FROM stream INTO projectionSink;
