# name: sources/FileConfig.test
# description: Forwarding queries with and without configurations
# groups: [Sources]

#==============================
#=====  NO Configuration  =====
#==============================

CREATE SINK noConfFileSink(noConfSourceFile.id UINT64, noConfSourceFile.value UINT64, noConfSourceFile.timestamp UINT64)  TYPE File;
CREATE LOGICAL SOURCE noConfSourceFile(id UINT64, value UINT64, timestamp UINT64);
CREATE PHYSICAL SOURCE FOR noConfSourceFile TYPE File SET('CSV' AS PARSER.`TYPE`);
ATTACH FILE small/stream8.csv

SELECT * FROM noConfSourceFile INTO noConfFileSink
----
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56

CREATE SINK noConfInlineSink(noConfSourceInline.id UINT64, noConfSourceInline.value UINT64, noConfSourceInline.timestamp UINT64)  TYPE File;
CREATE LOGICAL SOURCE noConfSourceInline(id UINT64, value UINT64, timestamp UINT64);
CREATE PHYSICAL SOURCE FOR noConfSourceInline TYPE File;
ATTACH INLINE
1,6,67
1,7,78
1,8,89
1,9,100

SELECT * FROM noConfSourceInline INTO noConfInlineSink
----
1,6,67
1,7,78
1,8,89
1,9,100

#================================
#===== Source Configuration =====
#================================

CREATE SINK sourceConfFileSink(sourceConfSourceFile.id UINT64, sourceConfSourceFile.value UINT64, sourceConfSourceFile.timestamp UINT64)  TYPE File;
CREATE LOGICAL SOURCE sourceConfSourceFile(id UINT64, value UINT64, timestamp UINT64);
CREATE PHYSICAL SOURCE FOR sourceConfSourceFile TYPE File;
ATTACH FILE small/stream8.csv

SELECT * FROM sourceConfSourceFile INTO sourceConfFileSink
----
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56

CREATE SINK sourceConfInlineSink(sourceConfSourceInline.id UINT64, sourceConfSourceInline.value UINT64, sourceConfSourceInline.timestamp UINT64)  TYPE File;
CREATE LOGICAL SOURCE sourceConfSourceInline(id UINT64, value UINT64, timestamp UINT64);
CREATE PHYSICAL SOURCE FOR sourceConfSourceInline TYPE File;
ATTACH INLINE
1,6,67
1,7,78
1,8,89
1,9,100

SELECT * FROM sourceConfSourceInline INTO sourceConfInlineSink
----
1,6,67
1,7,78
1,8,89
1,9,100


#========================================
#===== InputFormatter Configuration =====
#========================================

CREATE SINK inputFormatterConfInlineSink(inputFormatterConfSourceInline.id UINT64, inputFormatterConfSourceInline.value UINT64, inputFormatterConfSourceInline.timestamp UINT64)  TYPE File;
CREATE LOGICAL SOURCE inputFormatterConfSourceInline(id UINT64, value UINT64, timestamp UINT64);
CREATE PHYSICAL SOURCE FOR inputFormatterConfSourceInline TYPE File SET('|' AS PARSER.FIELD_DELIMITER);
ATTACH INLINE
1|6|67
1|7|78
1|8|89
1|9|100

SELECT * FROM inputFormatterConfSourceInline INTO inputFormatterConfInlineSink
----
1,6,67
1,7,78
1,8,89
1,9,100


#===================================================
#===== Source and InputFormatter Configuration =====
#===================================================

CREATE SINK sourceAndInputFormatterConfInlineSink(sourceAndInputFormatterConfSourceInline.id UINT64, sourceAndInputFormatterConfSourceInline.value UINT64, sourceAndInputFormatterConfSourceInline.timestamp UINT64)  TYPE File;
CREATE LOGICAL SOURCE sourceAndInputFormatterConfSourceInline(id UINT64, value UINT64, timestamp UINT64);
CREATE PHYSICAL SOURCE FOR sourceAndInputFormatterConfSourceInline TYPE File SET("|" AS PARSER.FIELD_DELIMITER);
ATTACH INLINE
1|6|67
1|7|78
1|8|89
1|9|100

SELECT * FROM sourceAndInputFormatterConfSourceInline INTO sourceAndInputFormatterConfInlineSink
----
1,6,67
1,7,78
1,8,89
1,9,100
