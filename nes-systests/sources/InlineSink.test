# name: sources/InlineSink.test
# description: Creating sink inline
# groups: [Sources]

SELECT ID, VALUE, TIMESTAMP
FROM File(
	'small/stream8.csv' AS `SOURCE`.FILE_PATH,
	'CSV' AS PARSER.`TYPE`,
	SCHEMA(id UINT64, value UINT64, timestamp UINT64) AS `SOURCE`.`SCHEMA`)
INTO File();
----
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56


SELECT ID, VALUE, TIMESTAMP
FROM File(
	'small/stream8.csv' AS `SOURCE`.FILE_PATH,
	'CSV' AS PARSER.`TYPE`,
	SCHEMA(id UINT64, value UINT64, timestamp UINT64) AS `SOURCE`.`SCHEMA`)
INTO Checksum();
----
5 1505

SELECT ID, VALUE, TIMESTAMP
FROM File(
	'small/stream8.csv' AS `SOURCE`.FILE_PATH,
	'CSV' AS PARSER.`TYPE`,
	SCHEMA(id UINT64, value UINT64, timestamp UINT64) AS `SOURCE`.`SCHEMA`)
INTO File();
====
SELECT ID, VALUE, TIMESTAMP
FROM File(
	'small/stream8.csv' AS `SOURCE`.FILE_PATH,
	'CSV' AS PARSER.`TYPE`,
	SCHEMA(id UINT64, value UINT64, timestamp UINT64) AS `SOURCE`.`SCHEMA`)
INTO File();


SELECT ID, VALUE, TIMESTAMP
FROM File(
	'small/stream8.csv' AS `SOURCE`.FILE_PATH,
	'CSV' AS PARSER.`TYPE`,
	SCHEMA(id UINT64, value UINT64, timestamp UINT64) AS `SOURCE`.`SCHEMA`)
INTO Checksum();
====
SELECT ID, VALUE, TIMESTAMP
FROM File(
	'small/stream8.csv' AS `SOURCE`.FILE_PATH,
	'CSV' AS PARSER.`TYPE`,
	SCHEMA(id UINT64, value UINT64, timestamp UINT64) AS `SOURCE`.`SCHEMA`)
INTO Checksum();
