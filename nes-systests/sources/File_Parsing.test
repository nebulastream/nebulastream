# name: sources/FileParsing.test
# description: Parses File (inline and as file) with different parsing options
# groups: [Sources]


## INLINE CSV
CREATE SINK inlineCSVSink(inlineCSVSource.id UINT64 NOT NULL, inlineCSVSource.value UINT64 NOT NULL, inlineCSVSource.timestamp UINT64 NOT NULL)  TYPE File;
CREATE LOGICAL SOURCE inlineCSVSource(id UINT64 NOT NULL, value UINT64 NOT NULL, timestamp UINT64 NOT NULL);
CREATE PHYSICAL SOURCE FOR inlineCSVSource TYPE File;
ATTACH INLINE
1,6,67
1,7,78
1,8,89
1,9,100

SELECT * FROM inlineCSVSource INTO inlineCSVSink;
----
1,6,67
1,7,78
1,8,89
1,9,100


## FILE CSV
CREATE SINK fileCSVSink(fileCSVSource.id UINT64 NOT NULL, fileCSVSource.value UINT64 NOT NULL, fileCSVSource.timestamp UINT64 NOT NULL)  TYPE File;
CREATE LOGICAL SOURCE fileCSVSource(id UINT64 NOT NULL, value UINT64 NOT NULL, timestamp UINT64 NOT NULL);
CREATE PHYSICAL SOURCE FOR fileCSVSource TYPE File;
ATTACH FILE small/stream8.csv

SELECT * FROM fileCSVSource INTO fileCSVSink;
----
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56

## INLINE PIPE
CREATE SINK inlinePipeCSVSink(inlinePipeCSVSource.id UINT64 NOT NULL, inlinePipeCSVSource.value UINT64 NOT NULL, inlinePipeCSVSource.timestamp UINT64 NOT NULL)  TYPE File;
CREATE LOGICAL SOURCE inlinePipeCSVSource(id UINT64 NOT NULL, value UINT64 NOT NULL, timestamp UINT64 NOT NULL);
CREATE PHYSICAL SOURCE FOR inlinePipeCSVSource TYPE File SET('|' AS PARSER.FIELD_DELIMITER);
ATTACH INLINE
1|6|67
1|7|78
1|8|89
1|9|100

SELECT * FROM inlinePipeCSVSource INTO inlinePipeCSVSink;
----
1,6,67
1,7,78
1,8,89
1,9,100

## FILE PIPE
CREATE SINK filePipeCSVSink(filePipeCSVSource.id UINT64 NOT NULL, filePipeCSVSource.value UINT64 NOT NULL, filePipeCSVSource.timestamp UINT64 NOT NULL)  TYPE File;
CREATE LOGICAL SOURCE filePipeCSVSource(id UINT64 NOT NULL, value UINT64 NOT NULL, timestamp UINT64 NOT NULL);
CREATE PHYSICAL SOURCE FOR filePipeCSVSource TYPE File SET('|' as PARSER.FIELD_DELIMITER);
ATTACH FILE small/stream8_pipe.csv

SELECT * FROM filePipeCSVSource INTO filePipeCSVSink;
----
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56
