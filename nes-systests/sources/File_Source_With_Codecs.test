# name: sources/File_Source_With_Codecs_test
# description: Testing the codec option for the source config
# groups: [Sources]

CREATE SINK sinkLz4MultiBuffer(lz4MultiBuffer.field_1 UINT64, lz4MultiBuffer.field_2 UINT64, lz4MultiBuffer.field_3 UINT64, lz4MultiBuffer.field_4 UINT64, lz4MultiBuffer.field_5 UINT64, lz4MultiBuffer.field_6 UINT64, lz4MultiBuffer.field_7 UINT64, lz4MultiBuffer.field_8 UINT64) TYPE Checksum;
CREATE LOGICAL SOURCE lz4MultiBuffer(field_1 UINT64, field_2 UINT64, field_3 UINT64, field_4 UINT64, field_5 UINT64, field_6 UINT64, field_7 UINT64, field_8 UINT64);
CREATE PHYSICAL SOURCE FOR lz4MultiBuffer TYPE FILE SET(
       'LZ4' as `SOURCE`.CODEC
);
ATTACH FILE small/200x8-rows-fields.lz4

# Description:
#   The data is LZ4Frame level 1 encoded and will be decoded in the source routine. It achieves a compression ratio of over
#   2 for this data set.
SELECT * FROM lz4MultiBuffer INTO sinkLz4MultiBuffer;
----
199, 533714
