# name: varsized.test
# description: Test for variable sized data types
# groups: [VariableSizedData]


CREATE LOGICAL SOURCE streamWithText(id UINT64, value UINT64, text1 VARSIZED, text2 VARSIZED);
CREATE PHYSICAL SOURCE FOR streamWithText TYPE File;
ATTACH INLINE
1,1,test1,test1
12,1,test1,test2
4,1,test2,test2
1,2,test1,test1
11,2,test3,test2
16,2,test1,test1
1,3,test1,test2
11,3,test3,test1
3,3,test1,test2
2,3,test1,test1
6,4,test1,test2
8,5,test1,test2

CREATE SINK sinkWindow(stream.id UINT64, stream.value UINT64, stream.timestamp UINT64)  TYPE File;
CREATE SINK sinkStreamWithText(streamWithText.id UINT64, streamWithText.value UINT64)  TYPE File;

# Filter equal with text
SELECT id, value FROM streamWithText WHERE text1 == VARSIZED("test1") AND text2 == VARSIZED("test2") INTO sinkStreamWithText;
----
12,1
1,3
3,3
6,4
8,5

# Filter equal with text
SELECT id, value FROM streamWithText WHERE CONCAT(text1,text2) == VARSIZED("test1test2") INTO sinkStreamWithText;
----
12,1
1,3
3,3
6,4
8,5