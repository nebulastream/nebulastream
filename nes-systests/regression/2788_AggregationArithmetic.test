# description: Regression test for issue #788 - post-aggregation arithmetic expressions
# groups: [regression]

CREATE LOGICAL SOURCE stream(i8 INT8, ts UINT64);
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH INLINE
1,100
2,125
3,150

CREATE SINK sinkResult(result FLOAT64) TYPE File;

# MEDIAN(i8) + FLOAT64(1): MEDIAN of {1,2,3} = 2, plus 1 = 3.
SELECT MEDIAN(i8) + FLOAT64(1) AS result FROM stream WINDOW TUMBLING(ts, size 100 ms) INTO sinkResult;
----
3

# SUM(i8) + FLOAT64(10): SUM of {1,2,3} = 6, plus 10 = 16.
SELECT SUM(i8) + FLOAT64(10) AS result FROM stream WINDOW TUMBLING(ts, size 100 ms) INTO sinkResult;
----
16
