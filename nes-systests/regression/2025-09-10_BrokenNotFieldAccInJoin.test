# description: reproduces for https://github.com/nebulastream/nebulastream/issues/1052
# groups: [regression]

Source stream UINT64 id UINT64 timestamp INLINE
1,1
2,1
3,1

Source stream2 UINT64 id2 UINT64 timestamp BOOLEAN e INLINE
1,1,false
2,1,false
3,1,false

SINK sink UINT64 i


SELECT id AS i FROM (SELECT * FROM stream)
INNER JOIN (SELECT * FROM stream2)
ON id = id2
AND NOT e
WINDOW TUMBLING (timestamp, size 1 sec) INTO sink;
----
1
2
3
