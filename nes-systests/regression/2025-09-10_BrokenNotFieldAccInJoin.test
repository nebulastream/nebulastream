# description: reproduces for https://github.com/nebulastream/nebulastream/issues/1052
# groups: [regression]

CREATE LOGICAL SOURCE stream(id UINT64, timestamp UINT64);
CREATE PHYSICAL SOURCE FOR stream TYPE File;
ATTACH INLINE
1,1
2,1
3,1

CREATE LOGICAL SOURCE stream2(id2 UINT64, timestamp UINT64, e BOOLEAN);
CREATE PHYSICAL SOURCE FOR stream2 TYPE File;
ATTACH INLINE
1,1,false
2,1,false
3,1,false

CREATE SINK sink(i UINT64) TYPE File;


SELECT id AS i FROM (SELECT * FROM stream)
INNER JOIN (SELECT * FROM stream2)
ON id = id2
AND NOT e
WINDOW TUMBLING (timestamp, size 1 sec) INTO sink;
----
1
2
3
