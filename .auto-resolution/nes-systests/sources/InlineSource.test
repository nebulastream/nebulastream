# name: sources/InlineSource.test
# description: Creating sources inline
# groups: [Sources]



CREATE SINK file_output(id UINT64, value UINT64, timestamp UINT64) TYPE File;

SELECT ID, VALUE, TIMESTAMP
FROM File(
	'small/stream8.csv' AS `SOURCE`.FILE_PATH,
	'CSV' AS PARSER.`TYPE`,
	SCHEMA(id UINT64, value UINT64, timestamp UINT64) AS `SOURCE`.`SCHEMA`)
INTO file_output;
----
1,1,12
1,2,23
1,3,34
1,4,45
1,5,56



CREATE SINK generator_output(id UINT64, field2 UINT64) TYPE File;

SELECT ID, FIELD2
FROM Generator(
    'ALL' as `SOURCE`.STOP_GENERATOR_WHEN_SEQUENCE_FINISHES,
    1000000 AS `SOURCE`.MAX_RUNTIME_MS,
    1 AS `SOURCE`.SEED,
    'CSV' AS PARSER.`TYPE`,
    'SEQUENCE UINT64 0 10 1, SEQUENCE UINT64 0 5 1' AS `SOURCE`.GENERATOR_SCHEMA,
    SCHEMA(id UINT64, field2 UINT64) AS `SOURCE`.`SCHEMA`)
INTO generator_output;
----
0 0
1 1
2 2
3 3
4 4
5 5
6 5
7 5
8 5
9 5


CREATE LOGICAL SOURCE input(id UINT64, value UINT64, timestamp UINT64);
CREATE PHYSICAL SOURCE FOR input TYPE File;
ATTACH FILE small/stream8.csv


SELECT input.ID AS ID, input.VALUE AS VALUE, input.TIMESTAMP AS TIMESTAMP
FROM input
INTO file_output;
====
SELECT ID, VALUE, TIMESTAMP
FROM File(
	'small/stream8.csv' AS `SOURCE`.FILE_PATH,
	'CSV' AS PARSER.`TYPE`,
	SCHEMA(id UINT64, value UINT64, timestamp UINT64) AS `SOURCE`.`SCHEMA`)
INTO file_output;
